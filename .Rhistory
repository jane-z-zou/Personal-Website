df %>% filter(DIFF_TIME == 0 | DIFF_TIME >= 2) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(DIFF_TIME) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE, BASELINE) %>% select(-...1)
df %>% group_by(PATIENT_ID, SITE, BASELINE)
df %>% group_by(PATIENT_ID, SITE)
df %>% group_by(PATIENT_ID, SITE, BASELINE)
library(tidyverse)
df <- read_csv("~/Downloads/Glaucoma Research Volunteer/10:14 Paracentral Scotoma PD/ALL_VF_EXAMS_Pattern_Deviation__1990_2020.csv",
col_types = cols(VISIT_DATE = col_date(format = "%m/%d/%y")))
df <- df %>% filter(DISPLAY_NAME %in% c("SS-24-2 Thr", "SS242 Thr")) %>% distinct()
df$PSD_PROBABILITY <- as.numeric(df$PSD_PROBABILITY)
df$FALSE_POSITIVE_PERCENT <- as.numeric(df$FALSE_POSITIVE_PERCENT)
df$GHT <- as.numeric(df$GHT)
df$MD <- as.numeric(df$MD)
df <- df %>% filter(PSD_PROBABILITY >= 1)
df <- df %>% filter(FALSE_POSITIVE_PERCENT < 15)
df <- df %>% filter(GHT == 2 | GHT == 3)
df <- df %>% filter(MD > -6)
idx_include <- c(1:27, which(colnames(df) == "L_23"),which(colnames(df) == "L_24"), which(colnames(df) == "L_32"),which(colnames(df) == "L_33"))
df <- df[colnames(df)[idx_include]]
df$L_23 <- as.numeric(df$L_23)
df$L_24 <- as.numeric(df$L_24)
df$L_33 <- as.numeric(df$L_33)
df$L_32 <- as.numeric(df$L_32)
df <- df[(df$L_23 <= -5 | df$L_24 <= -5 | df$L_32 <= -5 | df$L_33 <= -5), ]
df <- df %>% group_by(PATIENT_ID, SITE, VISIT_DATE, `...7`) %>% slice(1)
df <- df %>% group_by(PATIENT_ID, SITE) %>% mutate(COUNTS = n_distinct(VISIT_DATE)) %>% filter(COUNTS > 1) %>% select(-COUNTS)
df <- df %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(difftime(VISIT_DATE, BASELINE, units = "days")/365.25))
df <- df %>% group_by(PATIENT_ID, SITE, VISIT_DATE) %>% arrange(PATIENT_ID, SITE, VISIT_DATE, ...7) %>% slice(1) %>% distinct()
baseline <- df %>% filter(DIFF_TIME == 0)
df <- df %>% filter(DIFF_TIME != 0) %>% group_by(PATIENT_ID, SITE) %>% mutate(SECOND_DATE = min(DIFF_TIME)) %>% filter(DIFF_TIME == SECOND_DATE)
df <- df %>% select(-SECOND_DATE)
final <- rbind(baseline, df) %>% group_by(PATIENT_ID, SITE, VISIT_DATE) %>% arrange(PATIENT_ID, SITE, VISIT_DATE)
write.csv(final, "031224 - First2Visits.csv")
rm(list = ls())
df <- read_csv("~/Downloads/Glaucoma Research Volunteer/10:14 Paracentral Scotoma PD/ALL_VF_EXAMS_Pattern_Deviation__1990_2020.csv",
col_types = cols(VISIT_DATE = col_date(format = "%m/%d/%y")))
df <- df %>% filter(DISPLAY_NAME %in% c("SS-24-2 Thr", "SS242 Thr")) %>% distinct()
df$PSD_PROBABILITY <- as.numeric(df$PSD_PROBABILITY)
df$FALSE_POSITIVE_PERCENT <- as.numeric(df$FALSE_POSITIVE_PERCENT)
df$GHT <- as.numeric(df$GHT)
df$MD <- as.numeric(df$MD)
df <- df %>% filter(PSD_PROBABILITY >= 1)
df <- df %>% filter(FALSE_POSITIVE_PERCENT < 15)
df <- df %>% filter(GHT == 2 | GHT == 3)
idx_include <- c(1:27, which(colnames(df) == "L_23"),which(colnames(df) == "L_24"), which(colnames(df) == "L_32"),which(colnames(df) == "L_33"))
df <- df[colnames(df)[idx_include]]
df$L_23 <- as.numeric(df$L_23)
df$L_24 <- as.numeric(df$L_24)
df$L_33 <- as.numeric(df$L_33)
df$L_32 <- as.numeric(df$L_32)
df <- df[(df$L_23 <= -5 | df$L_24 <= -5 | df$L_32 <= -5 | df$L_33 <= -5), ]
df <- df %>% group_by(PATIENT_ID, SITE, VISIT_DATE, `...7`) %>% slice(1)
df <- df %>% group_by(PATIENT_ID, SITE) %>% mutate(COUNTS = n_distinct(VISIT_DATE)) %>% filter(COUNTS > 1) %>% select(-COUNTS)
df <- df %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(difftime(VISIT_DATE, BASELINE, units = "days")/365.25))
df <- df %>% group_by(PATIENT_ID, SITE, VISIT_DATE) %>% arrange(PATIENT_ID, SITE, VISIT_DATE, ...7) %>% slice(1) %>% distinct()
df <- df %>% group_by(PATIENT_ID, SITE) %>% arrange(PATIENT_ID, SITE) %>% slice(-(1:2))
compare <- read_csv("~/Downloads/Glaucoma Research Volunteer/10:14 Paracentral Scotoma PD/031224 - First2Visits.csv")
colnames(compare)[-1] <- colnames(df)
compare <- compare %>% select(-1)
df$FALSE_NEGATIVE_PERCENT <- as.numeric(df$FALSE_NEGATIVE_PERCENT)
df$...23 <- as.numeric(df$...23)
df$PSD <- as.numeric(df$PSD)
df$VFI <- as.numeric(df$VFI)
df <- df %>% filter(PATIENT_ID %in% compare$PATIENT_ID, BASELINE %in% compare$BASELINE)
use <- setdiff(df, compare) %>% distinct()
my_final <- rbind(compare, use) %>% distinct() %>% group_by(PATIENT_ID, SITE, VISIT_DATE) %>% arrange(PATIENT_ID, SITE, VISIT_DATE, ...7)
my_final <- my_final %>% group_by(PATIENT_ID, SITE, VISIT_DATE, ...7) %>% slice(1)
my_final <- my_final %>% arrange(PATIENT_ID, SITE, VISIT_DATE)
my_final %>% group_by(PATIENT_ID, SITE, BASELINE)
my_final %>% group_by(PATIENT_ID, SITE)
my_final %>% group_by(PATIENT_ID, SITE) %>% arrange(PATIENT_ID, SITE, BASELINE)
my_final %>% group_by(PATIENT_ID, SITE) %>% arrange(PATIENT_ID, SITE, BASELINE) %>% slice(1)
my_final %>% group_by()
my_final %>% group_by(PATIENT_ID, SITE, BASELINE)
my_final %>% group_by(PATIENT_ID, SITE) %>% summarize(n_distinct(BASELINE))
my_final %>% group_by(PATIENT_ID, SITE) %>% summarize(MULT_BASELINE = n_distinct(BASELINE)) %>% filter(MULT_BASELINE > 1)
my_final %>% group_by(PATIENT_ID, SITE) %>% mutate(MULT_BASELINE = n_distinct(BASELINE)) %>% filter(MULT_BASELINE > 1)
my_final %>% group_by(PATIENT_ID, SITE) %>% mutate(MULT_BASELINE = n_distinct(BASELINE)) %>% filter(MULT_BASELINE == 1)
keep <- my_final %>% group_by(PATIENT_ID, SITE) %>% mutate(MULT_BASELINE = n_distinct(BASELINE)) %>% filter(MULT_BASELINE == 1)
my_final %>% group_by(PATIENT_ID, SITE) %>% mutate(MULT_BASELINE = n_distinct(BASELINE)) %>% filter(MULT_BASELINE != 1)
fix <- my_final %>% group_by(PATIENT_ID, SITE) %>% mutate(MULT_BASELINE = n_distinct(BASELINE)) %>% filter(MULT_BASELINE != 1)
fix
fix %>% ungroup()
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% summarize(min(VISIT_DATE))
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% summarize(BASELINE = min(VISIT_DATE))
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>%
```
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE))
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(VISIT_DATE, BASELINE))/365.25))
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(VISIT_DATE, BASELINE)))/365.25)
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(VISIT_DATE, BASELINE, units = "days")))/365.25)
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(VISIT_DATE, BASELINE, units = "days")))/365.25) %>% mutate(MULT_BASELINE = n_distinct(BASELINE))
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(VISIT_DATE, BASELINE, units = "days")))/365.25) %>% mutate(MULT_BASELINE = n_distinct(BASELINE)) %>% filter(MULT_BASELINE != 1)
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(VISIT_DATE, BASELINE, units = "days")))/365.25) %>% mutate(MULT_BASELINE = n_distinct(BASELINE)) %>% filter(MULT_BASELINE != 1)
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(VISIT_DATE, BASELINE, units = "days")))/365.25) %>% mutate(MULT_BASELINE = n_distinct(BASELINE))
fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(VISIT_DATE, BASELINE, units = "days")))/365.25) %>% mutate(MULT_BASELINE = n_distinct(BASELINE))
fix <- fix %>% ungroup() %>% group_by(PATIENT_ID, SITE) %>% mutate(BASELINE = min(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(VISIT_DATE, BASELINE, units = "days")))/365.25) %>% mutate(MULT_BASELINE = n_distinct(BASELINE))
rbind(keep, fix)
rbind(keep, fix) %>% group_by(PATIENT_ID, SITE)
rbind(keep, fix) %>% group_by(PATIENT_ID, SITE, VISIT_DATE, ...7)
rbind(keep, fix) %>% group_by(PATIENT_ID, SITE, VISIT_DATE)
rbind(keep, fix) %>% group_by(PATIENT_ID, SITE, VISIT_DATE) %>% arrange(PATIENT_ID, SITE, VISIT_DATE)
rbind(keep, fix) %>% group_by(PATIENT_ID, SITE, VISIT_DATE) %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-MULT_BASELINE)
my_final <- rbind(keep, fix) %>% group_by(PATIENT_ID, SITE, VISIT_DATE) %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-MULT_BASELINE)
write.csv(my_final, "031224 - AllVisits.csv")
rm(list = ls())
library(tidyverse)
df <- read_csv("031224 - AllVisits.csv")
df %>% group_by(PATIENT_ID, SITE, BASELINE)
df %>% group_by(PATIENT_ID, SITE)
# min 2 year FU, min 5 visits
df %>% filter(DIFF_TIME == 0 | DIFF_TIME >= 2) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(DIFF_TIME) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE, BASELINE) %>% select(-...1)
# min 2 year FU, min 5 visits
df %>% filter(DIFF_TIME == 0 | DIFF_TIME >= 2) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(DIFF_TIME) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-...1)
# min 2 year FU, min 5 visits
df %>% filter(DIFF_TIME == 0 | DIFF_TIME >= 2) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(DIFF_TIME) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-...1)
# min 2 year FU, min 5 visits
f25 <- df %>% filter(DIFF_TIME == 0 | DIFF_TIME >= 2) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(DIFF_TIME) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-...1)
f25
f25 %>% group_by(PATIENT_ID, SITE)
f25 %>% group_by(PATIENT_ID) # 840 eyes
# 650 patients, 840 eyes
write.csv(f25, "031324 - AllVisits_2_5FU.csv")
f55 <- df %>% filter(DIFF_TIME == 0 | DIFF_TIME >= 5) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(DIFF_TIME) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-...1)
f55
f55 %>% group_by(PATIENT_ID) # 528 eyes
# 409 patients, 528 eyes
write.csv(f55, "031324 - AllVisits_5_5FU.csv")
df
rm(list = ls())
library(tidyverse)
df <- read_csv("031224 - AllVisits.csv")
# min 2 year FU, min 5 visits
f25 <- df %>% filter(DIFF_TIME == 0 | DIFF_TIME <= 2) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(DIFF_TIME) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-...1)
# 650 patients, 840 eyes
write.csv(f25, "031324 - AllVisits_2_5FU.csv")
# min 5 year FU, min 5 visits
f55 <- df %>% filter(DIFF_TIME == 0 | DIFF_TIME <= 5) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(DIFF_TIME) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-...1)
write.csv(f55, "031324 - AllVisits_5_5FU.csv")
f25 %>% group_by(PATIENT_ID)# 650 patients, 840 eyes
f25 %>% group_by(PATIENT_ID, SITE)# 13 patients, 840 eyes
f55 %>% group_by(PATIENT_ID, SITE)
f55 %>% group_by(PATIENT_ID)
f55 %>% group_by(PATIENT_ID, SITE)
write.csv(f55, "031324 - Min_5_5FU.csv")
write.csv(f25, "031324 - Min_2_5FU.csv")
setwd("/Users/lianzou/Downloads/Glaucoma Research Volunteer/10:14 Paracentral Scotoma PD")
rm(list = ls())
library(tidyverse)
df <- read_csv("031224 - AllVisits.csv")
# min 2 year FU, min 5 visits
df
# min 2 year FU, min 5 visits
df %>% group_by(PATIENT_ID, SITE)
# min 2 year FU, min 5 visits
df %>% group_by(PATIENT_ID, SITE) %>% summarize(max(VISIT_DATE))
# min 2 year FU, min 5 visits
df %>% group_by(PATIENT_ID, SITE) %>% summarize(FINAL_DATE = max(VISIT_DATE))
# min 2 year FU, min 5 visits
df %>% group_by(PATIENT_ID, SITE) %>% summarize(FINAL_DATE = max(VISIT_DATE)) %>% summarize(DIFF_TIME = difftime(FINAL_DATE, BASELINE))
# min 2 year FU, min 5 visits
df %>% group_by(PATIENT_ID, SITE) %>% summarize(FINAL_DATE = max(VISIT_DATE)) %>% summarize(INTERVAL = difftime(FINAL_DATE, BASELINE))
# min 2 year FU, min 5 visits
df
# min 2 year FU, min 5 visits
df <- df %>% select(-DIFF_TIME)
# min 2 year FU, min 5 visits
df <- df %>% select(-DIFF_TIME)
df %>% group_by(PATIENT_ID, SITE) %>% summarize(FINAL_DATE = max(VISIT_DATE)) %>% summarize(DIFF_TIME = difftime(FINAL_DATE, BASELINE))
df %>% group_by(PATIENT_ID, SITE) %>% summarize(FINAL_DATE = max(VISIT_DATE)) %>% mutate(DIFF_TIME = difftime(FINAL_DATE, BASELINE))
df %>% group_by(PATIENT_ID, SITE) %>% summarize(FINAL_DATE = max(VISIT_DATE))
df %>% group_by(PATIENT_ID, SITE) %>% mutate(FINAL_DATE = max(VISIT_DATE))
df %>% group_by(PATIENT_ID, SITE) %>% mutate(FINAL_DATE = max(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(BASELINE, FINAL_DATE))))
df %>% group_by(PATIENT_ID, SITE) %>% mutate(FINAL_DATE = max(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(BASELINE, FINAL_DATE, units = "days")/365.25)))
df <- df %>% group_by(PATIENT_ID, SITE) %>% mutate(FINAL_DATE = max(VISIT_DATE)) %>% mutate(DIFF_TIME = as.numeric(abs(difftime(BASELINE, FINAL_DATE, units = "days")/365.25)))
df %>% filter(DIFF_TIME == 0 | DIFF_TIME >= 2) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(VISIT_DATE) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-...1)
f25 <- df %>% filter(DIFF_TIME == 0 | DIFF_TIME >= 2) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(VISIT_DATE) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-...1)
write.csv(f25, "031424 - 2yr_5FU.csv")
f25
f25 %>% group_by(PATIENT_ID)
f25 %>% group_by(PATIENT_ID, SITE) # 836 patients,
# min 5 year FU, min 5 visits
f55 <- df %>% filter(DIFF_TIME == 0 | DIFF_TIME >= 5) %>% group_by(PATIENT_ID, SITE) %>% mutate(FOLLOW_UPS = n_distinct(VISIT_DATE) - 1) %>% filter(FOLLOW_UPS >= 5) %>% distinct() %>% arrange(PATIENT_ID, SITE, VISIT_DATE) %>% select(-...1)
f55 %>% group_by(PATIENT_ID, SITE) # 470 patients, 573 eyes
f55 %>% group_by(PATIENT_ID) # 470 patients, 935 eyes
# 731 patients, 935 eyes
write.csv(f55, "031424 - 5yr_5FU.csv")
setwd("/Users/lianzou/Downloads/Glaucoma Research Volunteer")
library(tidyverse)
df <- read_csv("Jf032024 - 5yr_5FU.csv")
library(lubridate)
df$VISIT_DATE <- parse_date_time(df$VISIT_DATE, "mdy")
df$BASELINE <- parse_date_time(df$BASELINE, "mdy")
df$FINAL_DATE <- parse_date_time(df$FINAL_DATE, "mdy")
df
df %>% filter(!is.na(`Baseline/Final`))
initial <- df %>% group_by(PATIENT_ID, EYE) %>% mutate(BASE = min(VISIT_DATE), FINALDATE = max(VISIT_DATE)) %>% filter(VISIT_DATE == BASE) %>% mutate(Initial = mean(MD))
final <- df %>% group_by(PATIENT_ID, EYE) %>% mutate(BASE = min(VISIT_DATE), FINALDATE = max(VISIT_DATE)) %>% filter(VISIT_DATE == FINALDATE) %>% mutate(Final = mean(MD))
initial <- initial %>% select(PATIENT_ID, EYE, BASE, Initial)
final <- final %>% select(PATIENT_ID, EYE, FINALDATE, Final)
my_final <- merge(initial, final)
my_final
write.csv(my_final, "Verify Jf032024 - 5yr_5FU.csv")
df <- read_csv("Jf032024 - 5yr_5FU.csv")
df <- df %>% group_by(PATIENT_ID, EYE) %>% mutate(`MD Averages` = mean(MD))
write.csv(df, "AvgMDColumn_Jf032024 - 5yr_5FU.csv")
df
rm(list = ls())
df <- df %>% filter(!is.na(`Baseline/Final`))
library(tidyverse)
df <- read_csv("Jf032024 - 5yr_5FU.csv")
library(lubridate)
df$VISIT_DATE <- parse_date_time(df$VISIT_DATE, "mdy")
df$BASELINE <- parse_date_time(df$BASELINE, "mdy")
df$FINAL_DATE <- parse_date_time(df$FINAL_DATE, "mdy")
df <- df %>% filter(!is.na(`Baseline/Final`))
df
df %>% filter(`Baseline/Final` == 1)
df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE)
df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID)
df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAD_MD = mean(MD))
df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% mutate(MEAD_MD = mean(MD))
df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAD_MD = mean(MD))
df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAD_MD = mean(MD))
df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE)
df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE)  %>% summarize(MEAD_MD = mean(MD))
df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAD_MD = mean(MD))
initial <- df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAD_MD = mean(MD))
initial
final <- df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAD_MD = mean(MD))
rbind(initial, final)
rbind(initial, final) %>% distinct()
initial <- df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAN_MD = mean(MD))
final <- df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAN_MD = mean(MD))
rbind(initial, final) %>% select(MEAN_MD)
initial
initial$DATE <- "Initial"
final$DATE <- "Final"
rbind(initial, final)
rbind(initial, final) %>% select(MEAN_MD, DATE)
keep <- rbind(initial, final) %>% select(MEAN_MD, DATE)
keep
hist(keep)
hist(keep$MEAN_MD)
keep %>% filter(DATE == "Initial")
keep %>% filter(DATE == "Initial") %>% select(MEAN_MD)
keep %>% filter(DATE == "Initial") %>% pull(MEAN_MD)
keep_ini <- keep %>% filter(DATE == "Initial") %>% pull(MEAN_MD)
hist(keep_ini)
hist(keep_ini, bins = 10)
hist(keep_ini, blocks = 10)
keep_fin <- keep %>% filter(DATE == "Final") %>% pull(MEAN_MD)
hist(keep_ini)
hist(keep_fin)
keep
keep %>% summarize(min(MEAN_MD))
keep %>% group_by(PATIENT_ID) %>% filter(DATE == "Initial") %>% summarize(min(MEAN_MD))
keep %>% filter(DATE == "Initial") %>% summarize(min(MEAN_MD))
min(keep_ini)
rm(list = ls())
library(tidyverse)
df <- read_csv("Jf032024 - 5yr_5FU.csv")
library(lubridate)
df$VISIT_DATE <- parse_date_time(df$VISIT_DATE, "mdy")
df$BASELINE <- parse_date_time(df$BASELINE, "mdy")
df$FINAL_DATE <- parse_date_time(df$FINAL_DATE, "mdy")
df <- df %>% filter(!is.na(`Baseline/Final`))
initial <- df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAN_MD = mean(MD))
final <- df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE) %>% summarize(MEAN_MD = mean(MD))
initial
initial <- df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize("Initial" = mean(MD))
final <- df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE) %>% summarize("Final" = mean(MD))
initial
rbind(initial, final)
library(tidyverse)
df <- read_csv("Jf032024 - 5yr_5FU.csv")
library(lubridate)
df$VISIT_DATE <- parse_date_time(df$VISIT_DATE, "mdy")
df$BASELINE <- parse_date_time(df$BASELINE, "mdy")
df$FINAL_DATE <- parse_date_time(df$FINAL_DATE, "mdy")
df <- df %>% filter(!is.na(`Baseline/Final`))
initial <- df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize("Initial" = mean(MD))
final <- df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE) %>% summarize("Final" = mean(MD))
rbind(initial, final)
initial <- df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize("Initial" = mean(MD))
final <- df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE) %>% summarize("Final" = mean(MD, na.rm = T))
rbind(initial, final)
cbind(initial, final)
merge(initial, final)
merge(initial, final) %>% group_by(PATIENT_ID, EYE)
merge(initial, final, by = "PATIENT_ID") %>% group_by(PATIENT_ID, EYE)
merge(initial, final, by = "PATIENT_ID")
merge(initial, final, by = c(PATIENT_ID, EYE))
merge(initial, final)
merge(initial, final) %>% group_by(Final)
merge(initial, final)
merge(initial, final) %>% arrange(PATIENT_ID, EYE)
keep <- merge(initial, final) %>% arrange(PATIENT_ID, EYE)
keep
merge(keep, df)
library(tidyverse)
df <- read_csv("Jf032024 - 5yr_5FU.csv")
library(lubridate)
df$VISIT_DATE <- parse_date_time(df$VISIT_DATE, "mdy")
df$BASELINE <- parse_date_time(df$BASELINE, "mdy")
df$FINAL_DATE <- parse_date_time(df$FINAL_DATE, "mdy")
initial <- df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize("Initial" = mean(MD))
final <- df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE) %>% summarize("Final" = mean(MD, na.rm = T))
keep <- merge(initial, final) %>% arrange(PATIENT_ID, EYE)
merge(keep, df)
my_final <- merge(keep, df)
write.csv(my_final, "Verify Jf032024 - 5yr_5FU.csv")
df <- read_csv("Verify Jf032024 - 5yr_5FU.csv")
df
df
df %>% select(PATIENT_ID, EYE, Initial, Final)
df <- df %>% select(PATIENT_ID, EYE, Initial, Final)
df
df %>% distinct()
df <- df %>% select(PATIENT_ID, EYE, Initial, Final) %>% distinct()
df
hist(df$Initial)
library(ggplot2)
ggplot(df, aes(x = Initial)) +
geom_histogram(binwidth = 1, color = "black", fill = "blue") +
theme_minimal() +
labs(title = "Histogram of Initial",
x = "Initial",
y = "Frequency") +
theme(text = element_text(size = 12))
ggplot(df, aes(x = Initial)) +
geom_histogram(binwidth = 0.5, color = "black", fill = "blue") +
theme_minimal() +
labs(title = "Histogram of Initial",
x = "Initial",
y = "Frequency") +
theme(text = element_text(size = 12))
ggplot(df, aes(x = Initial)) +
geom_histogram(bins = 50, color = "black", fill = "blue") +
theme_minimal() +
labs(title = "Histogram of Initial",
x = "Initial",
y = "Frequency") +
theme(text = element_text(size = 12))
ggplot(df, aes(x = Initial)) +
geom_histogram(bins = 30, color = "black", fill = "blue") +
theme_minimal() +
labs(title = "Histogram of Initial",
x = "Initial",
y = "Frequency") +
theme(text = element_text(size = 12))
ggplot(df, aes(x = Initial)) +
geom_histogram(bins = 30, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Initial",
x = "Initial",
y = "Frequency") +
theme(text = element_text(size = 12))
ggplot(df, aes(x = Initial)) +
geom_histogram(bins = 30, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Baseline MD Averages",
x = "Average Initial MD",
y = "Frequency") +
theme(text = element_text(size = 12))
ggplot(df, aes(x = Final)) +
geom_histogram(bins = 30, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Final MD Averages",
x = "Average Final MD",
y = "Frequency") +
theme(text = element_text(size = 12))
p1 <- ggplot(df, aes(x = Initial)) +
geom_histogram(bins = 30, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Baseline MD Averages",
x = "Average Initial MD",
y = "Frequency") +
theme(text = element_text(size = 12))
p2 <- ggplot(df, aes(x = Final)) +
geom_histogram(bins = 30, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Final MD Averages",
x = "Average Final MD",
y = "Frequency") +
theme(text = element_text(size = 12))
p1
p2
grid.arrange(p1, p2, ncol = 2)
library(gridExtra)
grid.arrange(p1, p2, ncol = 2)
df
rbind(df, df)
new <- rbind(df, df)
new
df
new[454:nrow(new)]
new[454:nrow(new), 3]
new[454:nrow(new), 3] <- new[454:nrow(new), 4]
new
colnames(new)[3] <- "Value"
colnames(new)[4] <- "Type of MD"
new$`Type of MD`
new$`Type of MD` <- c(rep("Initial", 454), rep("Final", 454))
new
rm(list = ls())
library(tidyverse)
df <- read_csv("Jf032024 - 5yr_5FU.csv")
library(lubridate)
df$VISIT_DATE <- parse_date_time(df$VISIT_DATE, "mdy")
df$BASELINE <- parse_date_time(df$BASELINE, "mdy")
df$FINAL_DATE <- parse_date_time(df$FINAL_DATE, "mdy")
initial <- df %>% filter(`Baseline/Final` == 1) %>% group_by(PATIENT_ID, EYE) %>% summarize("Initial" = mean(MD))
final <- df %>% filter(`Baseline/Final` == 2) %>% group_by(PATIENT_ID, EYE) %>% summarize("Final" = mean(MD, na.rm = T))
keep <- merge(initial, final) %>% arrange(PATIENT_ID, EYE)
my_final <- merge(keep, df)
write.csv(my_final, "Verify Jf032024 - 5yr_5FU.csv")
df <- read_csv("Verify Jf032024 - 5yr_5FU.csv")
df <- df %>% select(PATIENT_ID, EYE, Initial, Final) %>% distinct()
library(ggplot2)
p1 <- ggplot(df, aes(x = Initial)) +
geom_histogram(bins = 30, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Baseline MD Averages",
x = "Average Initial MD",
y = "Frequency") +
theme(text = element_text(size = 12))
p2 <- ggplot(df, aes(x = Final)) +
geom_histogram(bins = 30, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Final MD Averages",
x = "Average Final MD",
y = "Frequency") +
theme(text = element_text(size = 12))
p1
p2
library(gridExtra)
grid.arrange(p1, p2, ncol = 2)
final
final$`Type of MD` <- "Final"
initial$`Type of MD` <- "Initial"
rbind(initila, final)
rbind(initial, final)
initial
initial
colnames(initial)[3] <- "Value"
colnames(final)[3] <- "Value"
rbind(initial, final)
new <- rbind(initial, final)
ggplot(new, aes(x = Value, fill = `Type of MD`)) +
geom_histogram(alpha = 0.5, position = "identity", binwidth = 0.5) +
scale_fill_manual(values = c("blue", "red")) +
labs(title = "Overlayed Histograms", x = "Value", y = "Count") +
theme_minimal()
ggplot(new, aes(x = Value, fill = `Type of MD`)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 50) +
scale_fill_manual(values = c("blue", "red")) +
labs(title = "Overlayed Histograms", x = "Value", y = "Count") +
theme_minimal()
ggplot(new, aes(x = Value, fill = `Type of MD`)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 100) +
scale_fill_manual(values = c("blue", "red")) +
labs(title = "Overlayed Histograms", x = "Value", y = "Count") +
theme_minimal()
ggplot(new, aes(x = Value, fill = `Type of MD`)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 75) +
scale_fill_manual(values = c("blue", "red")) +
labs(title = "Overlayed Histograms", x = "Value", y = "Count") +
theme_minimal()
ggplot(new, aes(x = Value, fill = `Type of MD`)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 75) +
scale_fill_manual(values = c("blue", "red")) +
labs(title = "Combined Histogram of Average MD Values", x = "Average MD Value", y = "Frequency") +
theme_minimal()
p1 <- ggplot(df, aes(x = Initial)) +
geom_histogram(bins = 50, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Baseline MD Averages",
x = "Average Initial MD",
y = "Frequency") +
theme(text = element_text(size = 12))
p2 <- ggplot(df, aes(x = Final)) +
geom_histogram(bins = 50, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Final MD Averages",
x = "Average Final MD",
y = "Frequency") +
theme(text = element_text(size = 12))
p1
p2
p1 <- ggplot(df, aes(x = Initial)) +
geom_histogram(bins = 30, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Baseline MD Averages",
x = "Average Initial MD",
y = "Frequency") +
theme(text = element_text(size = 12))
p2 <- ggplot(df, aes(x = Final)) +
geom_histogram(bins = 30, color = "black", fill = "lightblue") +
theme_minimal() +
labs(title = "Histogram of Final MD Averages",
x = "Average Final MD",
y = "Frequency") +
theme(text = element_text(size = 12))
p1
p2
library(gridExtra)
grid.arrange(p1, p2, ncol = 2)
ggplot(new, aes(x = Value, fill = `Type of MD`)) +
geom_histogram(alpha = 0.5, position = "identity", bins = 75) +
scale_fill_manual(values = c("blue", "red")) +
labs(title = "Combined Histogram of Average MD Values", x = "Average MD Value", y = "Frequency") +
theme_minimal()
